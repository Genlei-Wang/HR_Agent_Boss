# åŠŸèƒ½æ‰©å±•æŒ‡å—

> ğŸ“š å¦‚ä½•æ·»åŠ æ–°åŠŸèƒ½å’Œæ‰©å±•æ’ä»¶èƒ½åŠ›

---

## ğŸ¯ å½“å‰åŠŸèƒ½

### å·²å®ç°åŠŸèƒ½
- âœ… AIæ™ºèƒ½åŒ¹é…å€™é€‰äººï¼ˆæ”¯æŒGeminiï¼‰
- âœ… è‡ªåŠ¨æ‰“æ‹›å‘¼
- âœ… è¿è¡Œæ—¥å¿—è®°å½•
- âœ… é…ç½®æŒä¹…åŒ–

### è®¡åˆ’åŠŸèƒ½
- ğŸ”² æ”¯æŒæ›´å¤šAIæ¨¡å‹ï¼ˆé€šä¹‰åƒé—®ã€Kimiç­‰ï¼‰
- ğŸ”² æ²Ÿé€šåˆ—è¡¨è‡ªåŠ¨è¦ç®€å†
- ğŸ”² æ²Ÿé€šåˆ—è¡¨è‡ªåŠ¨æ¥æ”¶ç®€å†
- ğŸ”² æ‰¹é‡æ“ä½œä¼˜åŒ–

---

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
boss-greeting-assistant/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ background/          # åå°æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ services/       # AIæœåŠ¡å®ç°ï¼ˆæ–°å¢ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ gemini-service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ qwen-service.ts      # å¾…å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ kimi-service.ts      # å¾…å®ç°
â”‚   â”‚   â”‚   â””â”€â”€ base-ai-service.ts   # åŸºç±»
â”‚   â”‚   â”œâ”€â”€ index.ts         # ä¸»å…¥å£
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ content/            # å†…å®¹è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ features/       # åŠŸèƒ½æ¨¡å—ï¼ˆæ–°å¢ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ chat-list-handler.ts # æ²Ÿé€šåˆ—è¡¨å¤„ç†
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ automation-controller.ts
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ shared/             # å…±äº«ä»£ç 
â”‚   â”‚   â”œâ”€â”€ ai-service.interface.ts  # AIæœåŠ¡æ¥å£ï¼ˆæ–°å¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ ai-config.ts             # AIæ¨¡å‹é…ç½®ï¼ˆæ–°å¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ types.ts
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ sidepanel/          # ä¾§è¾¹æ UI
â”‚       â”œâ”€â”€ components/
â”‚       â””â”€â”€ ...
```

---

## ğŸ”Œ æ·»åŠ æ–°çš„AIæ¨¡å‹

### æ­¥éª¤1ï¼šåˆ›å»ºæœåŠ¡å®ç°

åœ¨ `src/background/services/` ç›®å½•ä¸‹åˆ›å»ºæ–°æ–‡ä»¶ï¼Œä¾‹å¦‚ `qwen-service.ts`ï¼š

```typescript
import { BaseAIService } from './base-ai-service';
import type { AIModelConfig } from '../../shared/ai-service.interface';
import type { MatchResult } from '../../shared/types';

export class QwenService extends BaseAIService {
  constructor(config: AIModelConfig) {
    super(config);
  }
  
  async analyzeCandidate(
    imageBase64: string,
    jobDescription: string,
    candidateInfo?: { index: number; name: string; sessionDir?: string }
  ): Promise<MatchResult> {
    // å®ç°é€šä¹‰åƒé—®APIè°ƒç”¨é€»è¾‘
    const prompt = this.buildPrompt(jobDescription);
    const response = await this.callQwenAPI(prompt, imageBase64);
    return this.parseJsonResponse(response);
  }
  
  async testApiKey(): Promise<{ valid: boolean; error?: string; quotaExceeded?: boolean }> {
    // å®ç°API Keyæµ‹è¯•é€»è¾‘
  }
  
  private async callQwenAPI(prompt: string, imageBase64?: string): Promise<string> {
    // è°ƒç”¨é€šä¹‰åƒé—®API
  }
}
```

### æ­¥éª¤2ï¼šæ³¨å†Œåˆ°å·¥å‚

åœ¨ `src/shared/ai-service.interface.ts` çš„ `AIServiceFactory.createService` ä¸­æ·»åŠ ï¼š

```typescript
case 'qwen':
  const { QwenService } = await import('../background/services/qwen-service');
  return new QwenService(config);
```

### æ­¥éª¤3ï¼šæ·»åŠ é…ç½®

åœ¨ `src/shared/ai-config.ts` ä¸­æ·»åŠ æ¨¡å‹é…ç½®ï¼š

```typescript
qwen: {
  type: 'qwen',
  name: 'qwen',
  displayName: 'é€šä¹‰åƒé—® (Qwen)',
  endpoint: 'https://dashscope.aliyuncs.com/api/v1/services/aigc/multimodal-generation/generation',
  model: 'qwen-vl-plus',
  temperature: 0.2,
  maxTokens: 8192,
  timeout: 30000,
},
```

### æ­¥éª¤4ï¼šæ›´æ–°UI

åœ¨ `src/sidepanel/components/ConfigSection.tsx` ä¸­æ·»åŠ æ¨¡å‹é€‰æ‹©å™¨ã€‚

---

## ğŸ“‹ æ·»åŠ æ²Ÿé€šåˆ—è¡¨åŠŸèƒ½

### æ­¥éª¤1ï¼šåˆ›å»ºå¤„ç†å™¨

å·²åœ¨ `src/content/features/chat-list-handler.ts` åˆ›å»ºåŸºç¡€ç»“æ„ã€‚

### æ­¥éª¤2ï¼šå®ç°DOMé€‰æ‹©å™¨

åœ¨ `src/content/dom-selectors.ts` ä¸­æ·»åŠ æ²Ÿé€šåˆ—è¡¨ç›¸å…³çš„é€‰æ‹©å™¨ï¼š

```typescript
export const DOM_SELECTORS = {
  // ... ç°æœ‰é€‰æ‹©å™¨
  
  // æ²Ÿé€šåˆ—è¡¨ç›¸å…³
  CHAT_LIST: '.chat-list',
  CHAT_ITEM: '.chat-item',
  REQUEST_RESUME_BUTTON: 'button.request-resume',
  ACCEPT_RESUME_BUTTON: 'button.accept-resume',
};
```

### æ­¥éª¤3ï¼šé›†æˆåˆ°è‡ªåŠ¨åŒ–æ§åˆ¶å™¨

åœ¨ `src/content/automation-controller.ts` ä¸­æ·»åŠ æ²Ÿé€šåˆ—è¡¨å¤„ç†é€»è¾‘ã€‚

### æ­¥éª¤4ï¼šæ›´æ–°UI

åœ¨ä¾§è¾¹æ æ·»åŠ åŠŸèƒ½å¼€å…³ï¼š
- è‡ªåŠ¨è¦ç®€å†
- è‡ªåŠ¨æ¥æ”¶ç®€å†

---

## ğŸ”§ ä»£ç é‡æ„è¯´æ˜

### AIæœåŠ¡æŠ½è±¡

**ä¹‹å‰ï¼š** ç¡¬ç¼–ç GeminiæœåŠ¡
```typescript
const service = new GeminiService(apiKey);
```

**ç°åœ¨ï¼š** ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œæ”¯æŒå¤šæ¨¡å‹
```typescript
const service = await AIServiceFactory.createService({
  type: 'gemini',
  apiKey: apiKey,
  // ... å…¶ä»–é…ç½®
});
```

### é…ç½®ç»“æ„

**ä¹‹å‰ï¼š**
```typescript
{
  apiKey: string;
  // ...
}
```

**ç°åœ¨ï¼š**
```typescript
{
  aiModel: {
    type: 'gemini' | 'qwen' | 'kimi' | ...;
    apiKey: string;
    model?: string;
  };
  features: {
    autoGreet: boolean;
    autoRequestResume: boolean;
    autoAcceptResume: boolean;
  };
  // ...
}
```

---

## ğŸ“ å¼€å‘è§„èŒƒ

### 1. æ–‡ä»¶å‘½å
- æœåŠ¡å®ç°ï¼š`{model}-service.ts`
- åŠŸèƒ½å¤„ç†å™¨ï¼š`{feature}-handler.ts`
- æ¥å£å®šä¹‰ï¼š`*.interface.ts`

### 2. ä»£ç ç»„ç»‡
- æ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‹¬ç«‹æ–‡ä»¶
- å…±äº«é€»è¾‘æ”¾åœ¨ `shared/`
- UIç»„ä»¶æ”¾åœ¨ `sidepanel/components/`

### 3. ç±»å‹å®‰å…¨
- ä½¿ç”¨TypeScriptä¸¥æ ¼æ¨¡å¼
- å®šä¹‰æ¸…æ™°çš„æ¥å£
- é¿å…ä½¿ç”¨ `any`

### 4. é”™è¯¯å¤„ç†
- æ‰€æœ‰å¼‚æ­¥æ“ä½œéƒ½è¦æœ‰é”™è¯¯å¤„ç†
- æä¾›æœ‰æ„ä¹‰çš„é”™è¯¯ä¿¡æ¯
- è®°å½•é”™è¯¯æ—¥å¿—

---

## ğŸ§ª æµ‹è¯•æ–°åŠŸèƒ½

### 1. æœ¬åœ°æµ‹è¯•
```bash
npm run dev
```

### 2. æ„å»ºæµ‹è¯•
```bash
npm run build:prod
```

### 3. åŠŸèƒ½æµ‹è¯•
- åœ¨Bossç›´è˜é¡µé¢æµ‹è¯•
- æ£€æŸ¥æ—¥å¿—è¾“å‡º
- éªŒè¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [AIæ¨¡å‹å¯¹æ¯”åˆ†æ](ai-models/é€šä¹‰åƒé—®æ¨¡å‹å¯¹æ¯”åˆ†æ.md)
- [æŠ€æœ¯æ–¹æ¡ˆ](technical/æŠ€æœ¯æ–¹æ¡ˆ.md)
- [DOMé€‰æ‹©å™¨ä¿¡æ¯](dom/DOMé€‰æ‹©å™¨ä¿¡æ¯.md)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ·»åŠ æ–°AIæ¨¡å‹

1. å¤åˆ¶ `gemini-service.ts` ä¸º `{model}-service.ts`
2. ä¿®æ”¹APIè°ƒç”¨é€»è¾‘
3. åœ¨å·¥å‚ä¸­æ³¨å†Œ
4. æ·»åŠ é…ç½®
5. æ›´æ–°UI

### æ·»åŠ æ–°åŠŸèƒ½

1. åœ¨ `src/content/features/` åˆ›å»ºå¤„ç†å™¨
2. æ·»åŠ DOMé€‰æ‹©å™¨
3. é›†æˆåˆ°è‡ªåŠ¨åŒ–æ§åˆ¶å™¨
4. æ›´æ–°UIå’Œé…ç½®

---

**æœ€åæ›´æ–°**ï¼š2025-01-29

